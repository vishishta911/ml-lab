from sklearn.naive_bayes import GaussianNB
nb_model = GaussianNB()
nb_model.fit(x_train,y_train)
y_predict = nb_model.predict(x_test)
from sklearn.metrics import accuracy_score
print("Naive Bayes accuracy is",accuracy_score(y_test,y_predict)*100)
from sklearn.metrics import confusion_matrix
print("Confusion Matrix is \n",confusion_matrix(y_test,y_predict))
new_data = np.array([[6, 3.5, 2, 0.2]])
class_label = nb_model.predict(new_data)
if(class_label[0]) == 0:
    print("setosa")
elif(class_label[0]) == 1:
    print("versicolor")
else:
    print("virginica")


from sklearn.tree import DecisionTreeClassifier
dt_model1=DecisionTreeClassifier()
dt_model1.fit(x_train,y_train)
dt_model1_pred=dt_model1.predict(x_test)
from sklearn.metrics import accuracy_score
print('Decision tree model1 accuracy is',accuracy_score(y_test,dt_model1_pred)*100)
from sklearn.metrics import confusion_matrix
print('confusion matris is\n',confusion_matrix(y_test,dt_model1_pred))
print('correct predictions in setosa:',confusion_matrix(y_test,dt_model1_pred)[0][0])
print('correct predictions in versicolor:',confusion_matrix(y_test,dt_model1_pred)[1][1])
print('correct predictions in verginica:',confusion_matrix(y_test,dt_model1_pred)[2][2])
from sklearn.tree import plot_tree
plot_tree(dt_model1)
dt_model2=DecisionTreeClassifier(criterion='entropy')
dt_model2.fit(x_train,y_train)
dt_model2_pred=dt_model2.predict(x_test)
print('Decision tree model2 accuracy is',accuracy_score(y_test,dt_model2_pred)*100)
print('confusion matris is\n',confusion_matrix(y_test,dt_model2_pred))
print('correct predictions in setosa:',confusion_matrix(y_test,dt_model1_pred)[0][0])
print('correct predictions in versicolor:',confusion_matrix(y_test,dt_model1_pred)[1][1])
print('correct predictions in verginica:',confusion_matrix(y_test,dt_model1_pred)[2][2])
plot_tree(dt_model2)
# Apply the knowledge of model1 - DT with Gini index
# user input 
sepal_length = float(input("Enter sepal length:"))
sepal_width = float(input("Enter sepal width: "))
petal_length = float(input("Enter petal length: "))
petal_width = float(input("Enter petal width: "))
user_data = np.array([[sepal_length,sepal_width,petal_length,petal_width]])
# model1 predictions
model1_pred = dt_model1.predict(user_data)
if model1_pred==0:
    print("The flower is Setosa")
elif model1_pred==1:
    print("The flower is Versicolor")
else:
    print("The flower is Virginica")





from sklearn.neighbors import KNeighborsClassifier
knn_model=KNeighborsClassifier(n_neighbors=3)
knn_model.fit(x_train,y_train)
y_pred=knn_model.predict(x_test)
from sklearn.metrics import accuracy_score
print('knn accuracy is:',accuracy_score(y_test,y_pred)*100)
from sklearn.metrics import confusion_matrix
print('confusion matrix is:\n',confusion_matrix(y_test,y_pred))
print('setosa correct predictions',confusion_matrix(y_test,y_pred)[0][0])
print('versicolor correct predicitons',confusion_matrix(y_test,y_pred)[1][1])
print('verginica correct predicitons',confusion_matrix(y_test,y_pred)[2][2])




from sklearn.svm import SVC
svm_model=SVC()
svm_model.fit(x_train,y_train)
y_pred=svm_model.predict(x_test)
from sklearn.metrics import accuracy_score
print("SVM accuracy is",accuracy_score(y_test,y_pred)*100)
from sklearn.metrics import confusion_matrix
print("Confusion Matrix is \n",confusion_matrix(y_test,y_pred))
from sklearn.metrics import classification_report
print(classification_report(y_test, y_pred))
poly_svm=SVC(kernel='poly')
poly_svm.fit(x_train,y_train)
poly_svm_pred=poly_svm.predict(x_test)
print('polynomial svm accuracy is:',accuracy_score(y_test,poly_svm_pred)*100)
#radial bias function(rbf)
rbf_svm=SVC(kernel='rbf')
rbf_svm.fit(x_train,y_train)
rbf_svm_pred=rbf_svm.predict(x_test)
print('rbf svm accuracy is:',accuracy_score(y_test,rbf_svm_pred)*100)




from sklearn.ensemble import AdaBoostClassifier
#create model
ada_boost=AdaBoostClassifier()
ada_boost.fit(x_train,y_train)
y_pred=ada_boost.predict(x_test)
from sklearn.metrics import accuracy_score
print('adaboost classifier accuracy is:',accuracy_score(y_test,y_pred)*100)
from sklearn.metrics import confusion_matrix
print('confusion matrix is:\n',confusion_matrix(y_test,y_pred))
print('setosa correct predictions',confusion_matrix(y_test,y_pred)[0][0])
print('versicolor correct predicitons',confusion_matrix(y_test,y_pred)[1][1])
print('verginica correct predicitons',confusion_matrix(y_test,y_pred)[2][2])
print('incorrect predictions are:',confusion_matrix(y_test,y_pred)[2][1])
sl=int(input('enter sepal length (cm)'))
sw=int(input('enter sepal width (cm)'))
pl=int(input('enter petal length (cm)'))
pw=int(input('enter petal width (cm)'))
new_sample=np.array([[sl,sw,pl,pw]])
class_lab=ada_boost.predict(new_sample)
if class_lab[0]==0:
    print('predicted label is Setosa')
elif class_lab[0]==1:
    print('predicted label is Versicolor')
else:
    print('predicted label is Verginica')
